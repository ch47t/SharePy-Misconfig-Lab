{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>Join SharePy</h2>
    <form id="regForm">
        <input type="text" id="username" placeholder="Username" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit">Create Account</button>
    </form>
    <div class="link">
        <a href="/">Back to Login</a>
    </div>
</div>

<script>
document.getElementById('regForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const u = document.getElementById('username').value;
    const p = document.getElementById('password').value;

    const res = await fetch('/api/register', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({username: u, password: p})
    });

    if (res.ok) {
        alert("Account created! Please login.");
        window.location.href = '/';
    } else {
        //alert("Error creating account");
        const errorHtml = await res.text();
        document.open();
        document.write(errorHtml);
        document.close();
    }
});
</script>
{% endblock %}
